const n={append:"push",prepend:"unshift",pop:"pop",shift:"shift"};function t(n,t=document){return n instanceof Node?[n]:t.querySelectorAll(n)}function o(n,t=document){return n instanceof Node?n:t.querySelector(n)}function e(){return Math.random().toString(36).slice(2)}function c(n){return Array.isArray(n)?n.join(" "):"string"==typeof n?n:Object.entries(n).reduce((n,[t,o])=>o?n.concat(t):n,[])}function r(n,t){return n.split(".").reduce((n,t)=>n[t],t)}function s(n,t,o){return e=n,Boolean(e&&e.constructor&&e.call&&e.apply)?n(t,o):n;var e}function f(n,t){const o=[n];for(;o.length;){const n=o.shift();!1!==t(n)&&Array.from(n.children,n=>o.push(n))}}function u(n){if(!m.t.size)return null;let t=n;for(;t;){if(m.t.has(t))return m.t.get(t);t=t.parentElement}return null}function i(n,t,o){const[c,s]=n.value.split(/\s+in\s+/),f=r(s,o),u=document.createDocumentFragment();if(t.o){const e=[...new Set(t.o.map(n=>n.molecule))];for(const n of e)d(n),n.$root.parentElement.removeChild(n.$root);t.o=null,i(n,t,o)}else{t.o=[];for(let n=0,o=f.length;n<o;n++){const o=t.content.cloneNode(!0);for(const e of[...o.children])t.o.push({index:n,child:e}),u.append(e)}t.parentNode.insertBefore(u,t.nextSibling);for(const n of t.o){const{index:t,child:o}=n,r=l(e(),o);r.setup({$index:t,[c]:f[t]}),n.molecule=r,m.t.set(o,r),h(o),r.render()}}}function a(n,t,o){if(!n.name.startsWith("f-"))return;const e=r(n.value,o),c=n.name.slice(2);switch(e){case!0:t.setAttribute(c,"");break;case!1:t.removeAttribute(c);break;default:t.setAttribute(c,e)}}function l(e,l){const d={},p=n=>Object.assign(d,n),m=l?u(l.parentElement):null;function h(n=!0){const t=u(l);f(l,o=>{const e=u(o);if(e!==t)return n&&e.render(n),!1;for(const n of o.attributes)switch(n.name){case"f-text":o.textContent=r(n.value,d);break;case"f-html":o.innerHTML=r(n.value,d);break;case"f-each":i(n,o,d);break;default:a(n,o,d)}})}function $(n,t){p("object"==typeof n?Object.entries(n).reduce((n,[t,o])=>({...n,[t]:s(o,d[t],d)}),{}):{[n]:s(t,d[n],d)})}function b(n,t,e=null){return c=>{(e?o(e,l):c.currentTarget).classList[n](t)}}return m&&p({$parent:m.$data}),{set:(n,t)=>()=>{$(n,t),h()},setup(n,t){$(n,t)},on(n,o,e){const c=Array.isArray(e)?n=>e.forEach(t=>t(n)):e;for(const e of t(o,l))u(e).$root===l&&e.addEventListener(n,c)},addClass:(n,t=null)=>b("add",n,t),removeClass:(n,t=null)=>b("remove",n,t),toggleClass:(n,t=null)=>b("toggle",n,t),...Object.entries(n).reduce((n,[t,o])=>({...n,[t]:(n,t)=>()=>{d[n][o](s(t,d[n],d)),h()}}),{}),withEvent:n=>t=>n(t)(),render:h,classes:c,$data:d,$id:e,$root:l,$parent:m,$:n=>t(n,l),$$:n=>o(n,l)}}function d(n){const t=m.s.get(n)||[];for(const n of t)n.parentElement.removeChild(n)}const p=Object.keys(l());function m(n,t){t(Array.from(m.t.values()).find(t=>t.$id===n))}function h(n){const t=[],o=[];f(n,n=>{"SCRIPT"===n.tagName&&"fluor"===n.type&&t.push(n)});for(const n of t){const t=n.parentElement;let c;if(m.t.has(t))c=m.t.get(t);else{c=l(e(),t),m.t.set(t,c)}n.u=c,o.push(c)}const c=document.createDocumentFragment();for(const n of t){const t=n.u,o=document.createElement("script"),e=`Fluor("${t.$id}", ({${p.join(",")}}) => {${n.textContent}; render(false)})`;o.textContent=e,n.parentElement.removeChild(n),m.s.has(t)?m.s.set(t,[...m.s.get(t),o]):m.s.set(t,[o]),c.appendChild(o)}document.body.appendChild(c)}window.Fluor=m,m.t=new Map,m.s=new Map,async function(){await new Promise(n=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",n):n()}),h(document.body)}();